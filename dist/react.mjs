import e,{createContext as r,useState as t,useCallback as n,useContext as o}from"react";var a=function(e,r){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])},a(e,r)};var i=function(){return i=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},i.apply(this,arguments)};function s(e,r,t,n){return new(t||(t=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(i,s)}c((n=n.apply(e,r||[])).next())})}function c(e,r){var t,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=r.call(e,a)}catch(e){s=[6,e],n=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function l(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,a=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i}"function"==typeof SuppressedError&&SuppressedError;var d,f={exports:{}},h={};var p,g={};
/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */"production"===process.env.NODE_ENV?f.exports=function(){if(d)return h;d=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function t(r,t,n){var o=null;if(void 0!==n&&(o=""+n),void 0!==t.key&&(o=""+t.key),"key"in t)for(var a in n={},t)"key"!==a&&(n[a]=t[a]);else n=t;return t=n.ref,{$$typeof:e,type:r,key:o,ref:void 0!==t?t:null,props:n}}return h.Fragment=r,h.jsx=t,h.jsxs=t,h}():f.exports=(p||(p=1,"production"!==process.env.NODE_ENV&&function(){function r(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===_?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case p:return"Fragment";case v:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case S:return"SuspenseList";case D:return"Activity"}if("object"==typeof e)switch("number"==typeof e.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case h:return"Portal";case m:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:r(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return r(e(t))}catch(e){}}return null}function t(e){return""+e}function n(e){try{t(e);var r=!1}catch(e){r=!0}if(r){var n=(r=console).error,o="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(r,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",o),t(e)}}function o(e){if(e===p)return"<>";if("object"==typeof e&&null!==e&&e.$$typeof===C)return"<...>";try{var t=r(e);return t?"<"+t+">":"<...>"}catch(e){return"<...>"}}function a(){return Error("react-stack-top-frame")}function i(){var e=r(this.type);return O[e]||(O[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(e=this.props.ref)?e:null}function s(e,t,o,a,s,l){var d,h=t.children;if(void 0!==h)if(a)if(A(h)){for(a=0;a<h.length;a++)c(h[a]);Object.freeze&&Object.freeze(h)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else c(h);if(P.call(t,"key")){h=r(e);var p=Object.keys(t).filter(function(e){return"key"!==e});a=0<p.length?"{key: someKey, "+p.join(": ..., ")+": ...}":"{key: someKey}",I[h+a]||(p=0<p.length?"{"+p.join(": ..., ")+": ...}":"{}",console.error('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',a,h,p,h),I[h+a]=!0)}if(h=null,void 0!==o&&(n(o),h=""+o),function(e){if(P.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return void 0!==e.key}(t)&&(n(t.key),h=""+t.key),"key"in t)for(var g in o={},t)"key"!==g&&(o[g]=t[g]);else o=t;return h&&function(e,r){function t(){u||(u=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",r))}t.isReactWarning=!0,Object.defineProperty(e,"key",{get:t,configurable:!0})}(o,"function"==typeof e?e.displayName||e.name||"Unknown":e),function(e,r,t,n,o,a){var s=t.ref;return e={$$typeof:f,type:e,key:r,props:t,_owner:n},null!==(void 0!==s?s:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:i}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:o}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:a}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(e,h,o,null===(d=E.A)?null:d.getOwner(),s,l)}function c(e){l(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===C&&("fulfilled"===e._payload.status?l(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function l(e){return"object"==typeof e&&null!==e&&e.$$typeof===f}var u,d=e,f=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),m=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),_=Symbol.for("react.client.reference"),E=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=Object.prototype.hasOwnProperty,A=Array.isArray,j=console.createTask?console.createTask:function(){return null},O={},B=(d={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(d,a)(),N=j(o(a)),I={};g.Fragment=p,g.jsx=function(e,r,t){var n=1e4>E.recentlyCreatedOwnerStacks++;return s(e,r,t,!1,n?Error("react-stack-top-frame"):B,n?j(o(e)):N)},g.jsxs=function(e,r,t){var n=1e4>E.recentlyCreatedOwnerStacks++;return s(e,r,t,!0,n?Error("react-stack-top-frame"):B,n?j(o(e)):N)}}()),g);var y=f.exports,v=function(e){function r(r,t,n,o){var a=e.call(this,r)||this;return a.code=t,a.cacheType=n,a.originalError=o,a.name="CacheShieldError",a}return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}a(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}(r,e),r}(Error),b=function(){function e(e,r){this.config=e,this.logger=r}return e.prototype.clearCacheAPI=function(){return s(this,void 0,void 0,function(){var e,r,t,n,o,a,i,s,u;return c(this,function(c){switch(c.label){case 0:if(!("caches"in window))return[2,{type:"cacheAPI",success:!1,error:"Cache API not supported"}];c.label=1;case 1:return c.trys.push([1,11,,12]),[4,caches.keys()];case 2:e=c.sent(),r=0,c.label=3;case 3:c.trys.push([3,8,9,10]),t=l(e),n=t.next(),c.label=4;case 4:return n.done?[3,7]:(o=n.value,this.shouldExclude(o)?(this.logger.debug("Skipping cache: ".concat(o)),[3,6]):this.shouldInclude(o)?[4,caches.delete(o)]:[3,6]);case 5:c.sent(),r++,this.logger.debug("Deleted cache: ".concat(o)),c.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return a=c.sent(),s={error:a},[3,10];case 9:try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(s)throw s.error}return[7];case 10:return[2,{type:"cacheAPI",success:!0,itemsCleared:r}];case 11:throw i=c.sent(),new v("Failed to clear Cache API","UNKNOWN","cacheAPI",i instanceof Error?i:void 0);case 12:return[2]}})})},e.prototype.clearCookies=function(){return s(this,void 0,void 0,function(){var e,r,t,n,o,a,i,s,u,d,f,h,p,g,y,b;return c(this,function(c){try{e=this.config.cookies,r=null===(b=null==e?void 0:e.preserveEssential)||void 0===b||b,t=(null==e?void 0:e.essentialCookies)||[],n=null==e?void 0:e.names,o=null==e?void 0:e.domains,a=(null==e?void 0:e.paths)||["/"],i=this.parseCookies(),s=0,u=function(e){if(n&&n.length>0&&!n.includes(e.name))return"continue";if(r&&t.some(function(r){return e.name.toLowerCase().includes(r.toLowerCase())}))return d.logger.debug("Preserving essential cookie: ".concat(e.name)),"continue";d.deleteCookie(e.name,a,o),s++,d.logger.debug("Deleted cookie: ".concat(e.name))},d=this;try{for(f=l(i),h=f.next();!h.done;h=f.next())p=h.value,u(p)}catch(e){g={error:e}}finally{try{h&&!h.done&&(y=f.return)&&y.call(f)}finally{if(g)throw g.error}}return[2,{type:"cookies",success:!0,itemsCleared:s}]}catch(e){throw new v("Failed to clear cookies","UNKNOWN","cookies",e instanceof Error?e:void 0)}return[2]})})},e.prototype.parseCookies=function(){return document.cookie.split(";").map(function(e){var r=u(e.trim().split("="),2);return{name:r[0],value:r[1]||""}}).filter(function(e){return e.name})},e.prototype.deleteCookie=function(e,r,t){void 0===r&&(r=["/"]);var n="Thu, 01 Jan 1970 00:00:00 GMT",o=this.config.cookies;if(null==o?void 0:o.domain)this.deleteCookieWithDomain(e,r,[o.domain],n);else{var a=t||this.getDomainsToTry();this.deleteCookieWithDomain(e,r,a,n)}},e.prototype.getDomainsToTry=function(){var e=window.location.hostname,r=e.split("."),t=[""];if(e&&(t.push(e),t.push("."+e)),r.length>=2){var n=r.slice(-2).join(".");n!==e&&(t.push(n),t.push("."+n))}if(r.length>=3){var o=r.slice(-3).join(".");o!==e&&!t.includes(o)&&o.split(".").length>=2&&(t.push(o),t.push("."+o))}return function(e,r,t){if(t||2===arguments.length)for(var n,o=0,a=r.length;o<a;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))}([],u(new Set(t)),!1).filter(function(e){return""===e||"localhost"===e||/^\.?[a-zA-Z0-9][-a-zA-Z0-9]*(\.[a-zA-Z0-9][-a-zA-Z0-9]*)+$/.test(e)})},e.prototype.deleteCookieWithDomain=function(e,r,t,n){var o,a,i,s;try{for(var c=l(r),u=c.next();!u.done;u=c.next()){var d=u.value;try{for(var f=(i=void 0,l(t)),h=f.next();!h.done;h=f.next()){var p=h.value;if(!p||-1!==p.indexOf(".")||"localhost"===p){var g=p?"; domain=".concat(p):"";document.cookie="".concat(e,"=; expires=").concat(n,"; path=").concat(d).concat(g),document.cookie="".concat(e,"=; expires=").concat(n,"; path=").concat(d).concat(g,"; secure"),this.logger.debug('Attempted to delete cookie "'.concat(e,'"'),{domain:p||"(current)",path:d,timestamp:(new Date).toISOString()})}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}},e.prototype.shouldExclude=function(e){var r=this.config.exclude;return!(!r||0===r.length)&&r.some(function(r){return"string"==typeof r?e.includes(r):r.test(e)})},e.prototype.shouldInclude=function(e){var r=this.config.include;return!r||0===r.length||r.some(function(r){return"string"==typeof r?e.includes(r):r.test(e)})},e}(),m=function(){function e(e,r){this.config=e,this.logger=r}return e.prototype.clear=function(){return s(this,arguments,void 0,function(e){var r,t,n,o,a,i,s,u,d;return void 0===e&&(e={}),c(this,function(c){switch(c.label){case 0:if(!("serviceWorker"in navigator))return[2,{type:"serviceWorker",success:!1,error:"Service Workers not supported"}];c.label=1;case 1:return c.trys.push([1,13,,14]),[4,navigator.serviceWorker.getRegistrations()];case 2:r=c.sent(),t=0,c.label=3;case 3:c.trys.push([3,8,9,10]),n=l(r),o=n.next(),c.label=4;case 4:return o.done?[3,7]:(a=o.value,this.shouldExclude(a.scope)?(this.logger.debug("Skipping SW: ".concat(a.scope)),[3,6]):[4,a.unregister()]);case 5:c.sent()&&(t++,this.logger.debug("Unregistered SW: ".concat(a.scope))),c.label=6;case 6:return o=n.next(),[3,4];case 7:return[3,10];case 8:return i=c.sent(),u={error:i},[3,10];case 9:try{o&&!o.done&&(d=n.return)&&d.call(n)}finally{if(u)throw u.error}return[7];case 10:return e.skipCacheClear?[3,12]:[4,this.clearServiceWorkerCaches()];case 11:c.sent(),c.label=12;case 12:return[2,{type:"serviceWorker",success:!0,itemsCleared:t}];case 13:throw s=c.sent(),new v("Failed to clear Service Workers","UNKNOWN","serviceWorker",s instanceof Error?s:void 0);case 14:return[2]}})})},e.prototype.clearServiceWorkerCaches=function(){return s(this,void 0,void 0,function(){var e,r,t,n,o,a,i,s;return c(this,function(c){switch(c.label){case 0:return"caches"in window?[4,caches.keys()]:[2,0];case 1:e=c.sent(),r=0,c.label=2;case 2:c.trys.push([2,7,8,9]),t=l(e),n=t.next(),c.label=3;case 3:return n.done?[3,6]:(o=n.value,this.shouldExclude(o)?[3,5]:[4,caches.delete(o)]);case 4:c.sent(),r++,this.logger.debug("Deleted cache: ".concat(o)),c.label=5;case 5:return n=t.next(),[3,3];case 6:return[3,9];case 7:return a=c.sent(),i={error:a},[3,9];case 8:try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(i)throw i.error}return[7];case 9:return[2,r]}})})},e.prototype.shouldExclude=function(e){var r=this.config.exclude;return!(!r||0===r.length)&&r.some(function(r){return"string"==typeof r?e.includes(r):r.test(e)})},e.prototype.update=function(){return s(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:if(!("serviceWorker"in navigator))return[2,!1];t.label=1;case 1:return t.trys.push([1,5,,6]),[4,navigator.serviceWorker.getRegistration()];case 2:return(null==(e=t.sent())?void 0:e.waiting)?(e.waiting.postMessage({type:"SKIP_WAITING"}),[2,!0]):e?[4,e.update()]:[3,4];case 3:return t.sent(),[2,!0];case 4:return[2,!1];case 5:return r=t.sent(),this.logger.error("Failed to update Service Worker",r),[2,!1];case 6:return[2]}})})},e}(),w=function(){function e(e,r){this.config=e,this.logger=r}return e.prototype.clearLocalStorage=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.clearStorage("localStorage",localStorage)]})})},e.prototype.clearSessionStorage=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.clearStorage("sessionStorage",sessionStorage)]})})},e.prototype.clearStorage=function(e,r){return s(this,void 0,void 0,function(){var t,n,o,a,i,s,u,d,f,h,p,g,y,b,m,w,k,S;return c(this,function(c){try{for(t=this.config.storage,n=(null==t?void 0:t.preserveKeys)||[],o=null==t?void 0:t.preservePattern,a=null==t?void 0:t.keyPattern,i=[],s=[],u=0;u<r.length;u++)(b=r.key(u))&&(n.includes(b)||o&&o.test(b)?s.push(b):a&&!a.test(b)||i.push(b));d=0;try{for(f=l(i),h=f.next();!h.done;h=f.next())b=h.value,(p=r.getItem(b))&&(d+=b.length+p.length)}catch(e){m={error:e}}finally{try{h&&!h.done&&(w=f.return)&&w.call(f)}finally{if(m)throw m.error}}d*=2;try{for(g=l(i),y=g.next();!y.done;y=g.next())b=y.value,r.removeItem(b),this.logger.debug("Removed ".concat(e," key: ").concat(b))}catch(e){k={error:e}}finally{try{y&&!y.done&&(S=g.return)&&S.call(g)}finally{if(k)throw k.error}}return this.logger.info("".concat(e," cleared"),{removed:i.length,preserved:s.length}),[2,{type:e,success:!0,itemsCleared:i.length,bytesFreed:d}]}catch(r){throw new v("Failed to clear ".concat(e),"UNKNOWN",e,r instanceof Error?r:void 0)}return[2]})})},e.prototype.getStorageStats=function(){return{localStorage:this.calculateStorageSize(localStorage),sessionStorage:this.calculateStorageSize(sessionStorage)}},e.prototype.calculateStorageSize=function(e){for(var r=0,t=0;t<e.length;t++){var n=e.key(t);if(n){var o=e.getItem(n)||"";r+=2*(n.length+o.length)}}return r},e}(),k=function(){function e(e,r){this.config=e,this.logger=r}return e.prototype.clear=function(){return s(this,void 0,void 0,function(){var e,r,t,n,o,a,i,s,u,d,f,h,p,g;return c(this,function(c){switch(c.label){case 0:if(!("indexedDB"in window))return[2,{type:"indexedDB",success:!1,error:"IndexedDB not supported"}];c.label=1;case 1:return c.trys.push([1,14,,15]),[4,this.getDatabases()];case 2:e=c.sent(),r=this.config.indexedDB,t=null==r?void 0:r.databases,n=null===(g=null==r?void 0:r.deleteDatabase)||void 0===g||g,o=0,c.label=3;case 3:c.trys.push([3,11,12,13]),a=l(e),i=a.next(),c.label=4;case 4:return i.done?[3,10]:(s=i.value,(u=s.name)?t&&t.length>0&&!t.includes(u)?[3,9]:this.shouldExclude(u)?(this.logger.debug("Skipping IndexedDB: ".concat(u)),[3,9]):n?[4,this.deleteDatabase(u)]:[3,6]:[3,9]);case 5:return c.sent(),[3,8];case 6:return[4,this.clearDatabaseData(u)];case 7:c.sent(),c.label=8;case 8:o++,this.logger.debug("Cleared IndexedDB: ".concat(u)),c.label=9;case 9:return i=a.next(),[3,4];case 10:return[3,13];case 11:return d=c.sent(),h={error:d},[3,13];case 12:try{i&&!i.done&&(p=a.return)&&p.call(a)}finally{if(h)throw h.error}return[7];case 13:return[2,{type:"indexedDB",success:!0,itemsCleared:o}];case 14:throw f=c.sent(),new v("Failed to clear IndexedDB","UNKNOWN","indexedDB",f instanceof Error?f:void 0);case 15:return[2]}})})},e.prototype.getDatabases=function(){return s(this,void 0,void 0,function(){var e;return c(this,function(r){switch(r.label){case 0:if(!("databases"in indexedDB))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,indexedDB.databases()];case 2:return[2,r.sent()];case 3:return e=r.sent(),this.logger.warn("indexedDB.databases() failed",e),[2,this.getFallbackDatabases()];case 4:return[2,this.getFallbackDatabases()]}})})},e.prototype.getFallbackDatabases=function(){return s(this,void 0,void 0,function(){var e,r,t,n,o,a,i,s,u,d;return c(this,function(c){switch(c.label){case 0:if((e=(null===(d=this.config.indexedDB)||void 0===d?void 0:d.databases)||[]).length>0)return this.logger.debug("Using configured database names",e),[2,e.map(function(e){return{name:e}})];r=["firebaseLocalStorageDb","_ionicstorage","reactnative","redux-persist","localforage","ngsw:cache:v1","vuex-persist","pouchdb","__zone_symbol__Promise","default"],t=[],c.label=1;case 1:c.trys.push([1,8,9,10]),n=l(r),o=n.next(),c.label=2;case 2:if(o.done)return[3,7];a=o.value,c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.testDatabaseExists(a)];case 4:return c.sent()&&t.push({name:a}),[3,6];case 5:return c.sent(),[3,6];case 6:return o=n.next(),[3,2];case 7:return[3,10];case 8:return i=c.sent(),s={error:i},[3,10];case 9:try{o&&!o.done&&(u=n.return)&&u.call(n)}finally{if(s)throw s.error}return[7];case 10:return 0===t.length&&this.logger.warn("No IndexedDB databases found. Specify databases in config for Safari/older browsers.",{example:'indexedDB: { databases: ["my-db"] }'}),[2,t]}})})},e.prototype.testDatabaseExists=function(e){return new Promise(function(r){try{var t=indexedDB.open(e),n=!1;t.onsuccess=function(){var e=t.result;n=e.objectStoreNames.length>0,e.close(),r(n)},t.onerror=function(){r(!1)},t.onupgradeneeded=function(){t.result.close(),r(!1)},setTimeout(function(){!n&&t.result&&(t.result.close(),r(n))},1e3)}catch(e){r(!1)}})},e.prototype.deleteDatabase=function(e){var r=this;return new Promise(function(t,n){var o=indexedDB.deleteDatabase(e);o.onsuccess=function(){r.logger.debug("Deleted database: ".concat(e)),t()},o.onerror=function(){n(new Error("Failed to delete database: ".concat(e)))},o.onblocked=function(){r.logger.warn("Database deletion blocked: ".concat(e)),n(new Error("Database deletion blocked (open in another tab): ".concat(e)))}})},e.prototype.clearDatabaseData=function(e){return s(this,void 0,void 0,function(){var r=this;return c(this,function(t){return[2,new Promise(function(t,n){var o=indexedDB.open(e);o.onsuccess=function(){return s(r,void 0,void 0,function(){var r,a,i,s,u,d,f,h;return c(this,function(c){if(r=o.result,0===(a=Array.from(r.objectStoreNames)).length)return r.close(),t(),[2];i=r.transaction(a,"readwrite");try{for(s=l(a),u=s.next();!u.done;u=s.next())d=u.value,i.objectStore(d).clear()}catch(e){f={error:e}}finally{try{u&&!u.done&&(h=s.return)&&h.call(s)}finally{if(f)throw f.error}}return i.oncomplete=function(){r.close(),t()},i.onerror=function(){r.close(),n(new Error("Failed to clear data in: ".concat(e)))},[2]})})},o.onerror=function(){n(new Error("Failed to open database: ".concat(e)))}})]})})},e.prototype.shouldExclude=function(e){var r=this.config.exclude;return!(!r||0===r.length)&&r.some(function(r){return"string"==typeof r?e.includes(r):r.test(e)})},e}(),S=function(){function e(e){this.logger=e}return e.prototype.reload=function(e){void 0===e&&(e=!0),e?this.performCacheBustedReload():(this.logger.debug("Performing standard reload"),window.location.reload())},e.prototype.performCacheBustedReload=function(){this.logger.debug("Performing smart cache-busting reload");try{var e=new URL(window.location.href);e.searchParams.set("_cs_bust",Date.now().toString()),window.location.replace(e.toString())}catch(e){this.logger.warn("Smart reload failed, falling back to standard reload",e),window.location.reload()}},e}(),x=function(){function e(e){this.logger=e,this.initialized=!1,this.handler=null}return e.prototype.init=function(){var e=this;this.initialized||"undefined"==typeof window||(this.handler=function(r){r.persisted&&(e.logger.info("Page restored from bfcache detected, forcing reload to ensure freshness"),window.location.reload())},window.addEventListener("pageshow",this.handler),this.initialized=!0,this.logger.debug("BfCache protection initialized"))},e.prototype.destroy=function(){this.handler&&(window.removeEventListener("pageshow",this.handler),this.handler=null,this.initialized=!1,this.logger.debug("BfCache protection destroyed"))},e}(),C=function(){function e(e){void 0===e&&(e=!1),this.enabled=e,this.prefix="[CacheShield]"}return e.prototype.debug=function(e,r){this.log("debug",e,r)},e.prototype.info=function(e,r){this.log("info",e,r)},e.prototype.warn=function(e,r){this.log("warn",e,r)},e.prototype.error=function(e,r){this.log("error",e,r)},e.prototype.success=function(e,r){this.log("success",e,r)},e.prototype.log=function(e,r,t){if(this.enabled||"debug"!==e)if("undefined"!=typeof window&&"undefined"!=typeof document){console["error"===e?"error":"warn"===e?"warn":"log"]("%c".concat({debug:"üîç",info:"‚ÑπÔ∏è",warn:"‚ö†Ô∏è",error:"‚ùå",success:"‚úÖ"}[e]," ").concat(this.prefix," ").concat(r),{debug:"color: #888",info:"color: #2196F3",warn:"color: #FF9800",error:"color: #F44336",success:"color: #4CAF50"}[e],void 0!==t?t:"")}else{console["error"===e?"error":"warn"===e?"warn":"log"]("[".concat(e.toUpperCase(),"] ").concat(this.prefix," ").concat(r),void 0!==t?t:"")}},e}();function D(e){try{var r=window[e],t="__cache_shield_test__";return r.setItem(t,"test"),r.removeItem(t),!0}catch(e){return!1}}var _=function(){function e(e){void 0===e&&(e={}),this.config=this.mergeConfig(e),this.logger=new C(this.config.debug),this.capabilities={serviceWorker:"serviceWorker"in navigator,cacheAPI:"caches"in window,indexedDB:"indexedDB"in window,localStorage:D("localStorage"),sessionStorage:D("sessionStorage"),cookies:navigator.cookieEnabled,storageEstimate:"storage"in navigator&&"estimate"in navigator.storage,persistentStorage:"storage"in navigator&&"persist"in navigator.storage},this.browserCache=new b(this.config,this.logger),this.serviceWorker=new m(this.config,this.logger),this.storage=new w(this.config,this.logger),this.indexedDB=new k(this.config,this.logger),this.reloader=new S(this.logger),this.bfCache=new x(this.logger),this.config.preventBfCache&&this.bfCache.init(),this.logger.info("CacheShield initialized",{config:this.config,capabilities:this.capabilities})}return e.prototype.destroy=function(){this.bfCache.destroy()},e.prototype.clear=function(e){return s(this,void 0,void 0,function(){var r,t,n,o,a,s,u,d,f,h,p,g,y,v,b,m,w,k,S,x,C,D,_,E,P,A,j,O,B=this;return c(this,function(c){switch(c.label){case 0:r=performance.now(),t=e?this.mergeConfig(i(i({},this.config),e)):this.config,n=this.resolveTargets(t.targets),this.logger.info("Starting cache clear",{targets:n}),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,null===(D=(C=t.hooks).onBeforeClear)||void 0===D?void 0:D.call(C,n)];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),this.logger.error("onBeforeClear hook failed",o),[3,4];case 4:a=[],s=n.length,u=0,d=n.includes("cacheAPI"),c.label=5;case 5:c.trys.push([5,13,14,15]),f=l(n),h=f.next(),c.label=6;case 6:if(h.done)return[3,12];p=h.value,c.label=7;case 7:return c.trys.push([7,9,,10]),[4,this.clearCacheType(p,{skipCacheClear:"serviceWorker"===p&&d})];case 8:return g=c.sent(),a.push(g),g.success?this.logger.success("Cleared ".concat(p),g):this.logger.warn("Failed to clear ".concat(p),g),[3,10];case 9:y=c.sent(),v=this.wrapError(y,p);try{null===(E=(_=t.hooks).onError)||void 0===E||E.call(_,v)}catch(e){this.logger.error("onError hook failed",e)}return a.push({type:p,success:!1,error:v.message}),[3,10];case 10:u++;try{null===(A=(P=t.hooks).onProgress)||void 0===A||A.call(P,{current:p,completed:u,total:s,percentage:Math.round(u/s*100)})}catch(e){this.logger.error("onProgress hook failed",e)}c.label=11;case 11:return h=f.next(),[3,6];case 12:return[3,15];case 13:return b=c.sent(),S={error:b},[3,15];case 14:try{h&&!h.done&&(x=f.return)&&x.call(f)}finally{if(S)throw S.error}return[7];case 15:m=performance.now()-r,w={success:a.every(function(e){return e.success}),cleared:a.filter(function(e){return e.success}),failed:a.filter(function(e){return!e.success}),timestamp:Date.now(),duration:m},this.logger.info("Cache clear completed",w),c.label=16;case 16:return c.trys.push([16,18,,19]),[4,null===(O=(j=t.hooks).onAfterClear)||void 0===O?void 0:O.call(j,w)];case 17:return c.sent(),[3,19];case 18:return k=c.sent(),this.logger.error("onAfterClear hook failed",k),[3,19];case 19:return t.autoReload&&w.success&&setTimeout(function(){B.reloader.reload(!0)},t.reloadDelay),[2,w]}})})},e.prototype.clearCacheType=function(e){return s(this,arguments,void 0,function(e,r){return void 0===r&&(r={}),c(this,function(t){switch(e){case"serviceWorker":return[2,this.serviceWorker.clear(r)];case"cacheAPI":return[2,this.browserCache.clearCacheAPI()];case"localStorage":return[2,this.storage.clearLocalStorage()];case"sessionStorage":return[2,this.storage.clearSessionStorage()];case"indexedDB":return[2,this.indexedDB.clear()];case"cookies":return[2,this.browserCache.clearCookies()];default:return[2,{type:e,success:!1,error:"Unknown cache type: ".concat(e)}]}})})},e.prototype.clearServiceWorkers=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.serviceWorker.clear()]})})},e.prototype.clearCacheAPI=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.browserCache.clearCacheAPI()]})})},e.prototype.clearLocalStorage=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.storage.clearLocalStorage()]})})},e.prototype.clearSessionStorage=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.storage.clearSessionStorage()]})})},e.prototype.clearIndexedDB=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.indexedDB.clear()]})})},e.prototype.clearCookies=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,this.browserCache.clearCookies()]})})},e.prototype.hardReload=function(){this.reloader.reload(!0)},e.prototype.clearAndReload=function(e){return s(this,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return[4,this.clear(e)];case 1:return r.sent(),this.hardReload(),[2]}})})},e.prototype.getStorageEstimate=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return"storage"in navigator&&"estimate"in navigator.storage?[2,navigator.storage.estimate()]:[2,null]})})},e.prototype.getCapabilities=function(){return this.capabilities},e.prototype.resolveTargets=function(e){var r=this;if(e.includes("all")){return["serviceWorker","cacheAPI","localStorage","sessionStorage","indexedDB","cookies"].filter(function(e){switch(e){case"serviceWorker":return r.capabilities.serviceWorker;case"cacheAPI":return r.capabilities.cacheAPI;case"indexedDB":return r.capabilities.indexedDB;default:return!0}})}return e},e.prototype.mergeConfig=function(r){return i(i(i({},e.DEFAULTS),r),{cookies:i(i({},e.DEFAULTS.cookies),r.cookies),indexedDB:i(i({},e.DEFAULTS.indexedDB),r.indexedDB),storage:i(i({},e.DEFAULTS.storage),r.storage),hooks:i(i({},e.DEFAULTS.hooks),r.hooks)})},e.prototype.wrapError=function(e,r){if(e instanceof v)return e;var t=e instanceof Error?e:new Error(String(e));return new v("Failed to clear ".concat(r,": ").concat(t.message),"UNKNOWN",r,t)},e.DEFAULTS={targets:["all"],include:[],exclude:[],cookies:{preserveEssential:!0,essentialCookies:["csrf","session","auth"]},indexedDB:{deleteDatabase:!0},storage:{preserveKeys:[]},debug:!1,hooks:{},autoReload:!1,reloadDelay:100,preventBfCache:!1},e}(),E=r(null);function P(e){var r=this,o=e.children,a=e.config,i=u(t(function(){return new _(a)}),1)[0],l=u(t(!1),2),d=l[0],f=l[1],h=u(t(null),2),p=h[0],g=h[1],v=n(function(e){return s(r,void 0,void 0,function(){var r;return c(this,function(t){switch(t.label){case 0:f(!0),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,i.clear(e)];case 2:return r=t.sent(),g(r),[2,r];case 3:return f(!1),[7];case 4:return[2]}})})},[i]),b=n(function(e){return s(r,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:f(!0),r.label=1;case 1:switch(r.trys.push([1,,15,16]),e){case"serviceWorker":return[3,2];case"localStorage":return[3,4];case"sessionStorage":return[3,6];case"indexedDB":return[3,8];case"cookies":return[3,10];case"cacheAPI":return[3,12]}return[3,14];case 2:return[4,i.clearServiceWorkers()];case 3:return r.sent(),[3,14];case 4:return[4,i.clearLocalStorage()];case 5:return r.sent(),[3,14];case 6:return[4,i.clearSessionStorage()];case 7:return r.sent(),[3,14];case 8:return[4,i.clearIndexedDB()];case 9:return r.sent(),[3,14];case 10:return[4,i.clearCookies()];case 11:return r.sent(),[3,14];case 12:return[4,i.clearCacheAPI()];case 13:return r.sent(),[3,14];case 14:return[3,16];case 15:return f(!1),[7];case 16:return[2]}})})},[i]),m=n(function(){i.hardReload()},[i]),w={shield:i,isClearing:d,lastResult:p,clear:v,clearType:b,hardReload:m,capabilities:i.getCapabilities()};return y.jsx(E.Provider,{value:w,children:o})}function A(){var e=o(E);if(!e)throw new Error("useCacheShield must be used within CacheShieldProvider");return e}function j(e){var r=this,o=u(t(function(){return new _(e)}),1)[0],a=u(t(!1),2),i=a[0],l=a[1],d=u(t(null),2),f=d[0],h=d[1],p=n(function(e){return s(r,void 0,void 0,function(){var r;return c(this,function(t){switch(t.label){case 0:l(!0),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,o.clear(e)];case 2:return r=t.sent(),h(r),[2,r];case 3:return l(!1),[7];case 4:return[2]}})})},[o]);return{clear:p,isClearing:i,lastResult:f,shield:o}}function O(e){var r=this,t=e.children,n=void 0===t?"Clear Cache":t,o=e.onSuccess,a=e.onError,i=e.options,l=e.className,u=e.disabled,d=A(),f=d.clear,h=d.isClearing;return y.jsx("button",{onClick:function(){return s(r,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,f(i)];case 1:return e=t.sent(),null==o||o(e),[3,3];case 2:return r=t.sent(),null==a||a(r instanceof Error?r:new Error(String(r))),[3,3];case 3:return[2]}})})},disabled:u||h,className:l,children:h?"Clearing...":n})}export{P as CacheShieldProvider,O as ClearCacheButton,A as useCacheShield,j as useCacheShieldSimple};
